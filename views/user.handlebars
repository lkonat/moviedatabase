{{#if login}}
<div id="main_content" data-id ='{{login}}' style="width:100%; padding:10px;">
   {{#if is_admin }}
   <div id="user_view_div" style="width:100%; height:auto; margin:0 auto;  border-bottom:1px solid lightgrey; margin-bottom:30px; font-size:0.7em;">
     <div id="user_view_div_image" style="width:30%; height:200px;  overflow-y:scroll; overflow-x:hide;  margin-bottom:30px; font-size:0.7em;float:left; display:none;">

     </div>
     <div id="user_view_div_info" style="width:60%; height:200px;  overflow-y:scroll; overflow-x:hide;  margin-bottom:30px; font-size:0.7em;float:right; display:none;">

     </div>
   </div>
     {{else}}
     {{#if users_id}}
     <div class="photoDiv" style="width:100%; height:230px; margin:0 auto; overflow-y:scroll; overflow-x:hide; border-bottom:1px solid grey; margin-bottom:30px;">
        <div class="imageDiv" id='images_area' style="width:100%; height:200px; margin:0 auto; padding-top:30px;">
          <div id="addPhotoLink" style='width:100%; margin:0 auto; color:grey; height:30px; text-align:center; cursor:pointer;'>
            Click here to Add Photo
          </div>
            <div id="progressBarDiv" style='position:relative; width:100%; margin:0 auto; color:grey; height:30px;  background-color:grey;'>
              <div id="progressBar" style="width:10px; height:30px; background-color:green; line-height:30px;"></div>
              <span id="progressText" style="position:absolute; top:0px; left:50%; color:white;">  </span>
            </div>
        </div>
     </div>
     {{/if}}
   {{/if}}

  <div class="" style="float:left; border-bottom:1px solid grey;width:100%; font-size:0.8em; ">
    <h3>Basic Info</h3>
    {{#if is_admin }}
    {{else}}
    {{#if admin_request }}
    {{else}}
     <span id='admin_request_sender' data-id ="{{login}}" style='cursor:pointer;'>Send an Admin Request</span>
     {{/if}}
    {{/if}}
    <table class='user_info_table' style="width:100%;">
      {{# each user_info}}
           <tr><td class="user_info_titles">{{label}}</td><td class="user_info_values" id='{{name}}'> {{value}}  </td><td><small class='user_info_edit_links' data-name='{{name}}' data-label='{{label}}' data-value='{{value}}' data-table='users'>&#x270E;</small></td></tr>
      {{/each}}
      <!--For the password -->
      <tr><td class="user_info_titles">Password:</td><td class="user_info_values">	&#x1f512;</td><td><small class='user_info_edit_links' data-name='password' data-table='users'>&#x270E;</small></td></tr>
    </table>

    </div>
    {{#if is_admin }}
        <div class="" style="float:right; background:linear-gradient(#000, #999 10%, #000); padding:10px; ">
          <center><h5 style='color:grey;'>Current Admin Request</h5></center>
          <div class="" id='admin_request_panel' style="    min-height:30px;  max-height:300px; overflow:scroll; border-bottom:1px solid grey;">
          </div>
          <center><h5 style='color:grey;'>Accepted Request </h5></center>
          <div class="" id='current_user_panel' style="    min-height:30px;  max-height:300px; overflow:scroll;">
          </div>
        </div>
    {{else}}
         {{#if users_id}}
           <div id="actor_info" style=' clear:both; padding-top:30px; '>
             <div class="row">
            {{else}}
               <br>
               <span id='file_profile' onclick="becomeActor();" style="clear:both;float:left; color:white; font-size:0.8em; cursor:pointer;"><span style="font-size:1.2em; color:darkred;">&#9432; </span>Please click here to create your actor profile</span>
               <div id="actor_info" style=' clear:both; padding-top:30px; display:none; '>
                <div class="row">
         {{/if}}
         <div id=""  class="col-sm-4">
           <table class='user_info_table' style="width:100%; font-size:0.8em;">
           <h3>Actor Info</h3>
             {{# each actor_info}}
                <tr><td class="user_info_titles">{{label}}</td><td class="user_info_values" id='{{name}}'> {{value}}  </td><td><small class='user_info_edit_links' data-name='{{name}}' data-label='{{label}}' data-value='{{value}}' data-table='actors'>&#x270E;</small></td></tr>
             {{/each}}
           </table>
         </div>
             <div  class="col-sm-4" >
               <h3>Measurements</h3>
               <table class='user_info_table' style="width:100%; font-size:0.8em;">
                 {{# each actors_measurement}}
                    <tr><td class="user_info_titles">{{label}}</td><td class="user_info_values" id='{{name}}'> {{value}}  </td><td><small class='user_info_edit_links' data-name='{{name}}' data-label='{{label}}' data-value='{{value}}' data-table='actors'>&#x270E;</small></td></tr>
                 {{/each}}
               </table>
             </div>
            <br>
            <br>
            <div class=""  class="col-sm-4">
              <!-- <h3>Emergency Contact</h3>
              <table class='user_info_table' style="width:100%; font-size:0.8em;">
                 <tr><td class="user_info_titles">Name:</td><td class="user_info_values"> {{  emergency_name}} </td><td><small class='user_info_edit_links' data-name='emergency_name' data-label='emergency name' data-value='{{emergency_name}}' data-table='actors'>&#x270E;</small></td></tr>
                 <tr><td class="user_info_titles">Phone:</td><td class="user_info_values"> {{  emergency_number }} </td><td><small class='user_info_edit_links' data-name='emergency_number' data-label='Emergency Number' data-value='{{emergency_number }}' data-table='actors'>&#x270E;</small></td></tr>
              </table>
              <br> -->
              <h3>Cars Owned</h3>
              <table class='user_info_table' id='car_owned' style="width:100%; font-size:0.8em;">
                {{#if cars}}
                {{#each cars}}
                 <tr>
                   <td class="user_info_titles" style='color:black;'>&#x1F698;</td>
                   <td class="user_info_values"> {{this.make}} </td>
                   <td class="user_info_values"> {{this.color}} </td>
                   <td class="user_info_values"> {{this.year}} </td>
                   <td><small class='user_info_edit_links' data-name='cars' data-label='Cars Info' data-value='love' data-table='cars' data-tableid="{{this.id}}">&#x270E;</small></td>
                   </tr>
                   {{/each}}
                   <tr>
                     <td id ='add_car' class="user_info_titles" colspan="3">Add New Car</td>
                     <td><small class='user_info_edit_links' data-name='cars' data-label='Cars Info' data-value='love' data-table='cars' style="visibility:visible;">&#x270E;</small></td>
                   </tr>
                   {{else}}
                   <tr >
                     <td id ='add_car' class="user_info_titles">no car</td>
                     <td><small class='user_info_edit_links' data-name='cars' data-label='Cars Info' data-value='love' data-table='cars' >&#x270E;</small></td>
                   </tr>
                {{/if}}
              </table>
            </div>
          </div>
    {{/if}}

  </div>
</div>
<script src="https://code.jquery.com/jquery-2.0.2.min.js"> </script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script type="text/javascript">

 $("#admin_request_sender").click(function(){
   console.log("sending request");
   post("/update-user-info",{request_type:'admin_request',table_name:"users",target:"admin_request",id:this.dataset.id,value:1},function(data){
     console.log("success",data);
   });
 });
displayAllUsers();
 function displayAllUsers(){

  console.log("current users panel ",$("#admin_request_panel").length);
  if($("#admin_request_panel").length>0){
    //display all users
    $("#admin_request_panel").empty();
      $("#current_user_panel").empty();

     $.ajax({
         url: "/get-all-users",
         type: 'POST',
         success: function(data){
             if(data.success){
               console.log("success: ",data.success);
              for( key in data.success){
                console.log(key, data.success[key]);
                var box =$("<div class='available_users'  data-id ='"+data.success[key].id+"'style='width:400px; height:30px; cursor:pointer; font-size:0.8em;background-color:grey; color:white; margin-bottom:7px; border:2px solid grey; border-radius:10px;'>"+data.success[key].last_name+" "+data.success[key].first_name+"  "+(data.success[key].is_admin?"<span>&#x1f511;</span>":"")+""+(data.admin_id===data.success[key].id?"<span style='color: black; font-weight:bold; margin-left:7px;'>Me</span>":"")+"</div>");
                var image = $("<img src='img/user.png' style='height:90%; width:30px;' alt=''>");
                var accept = $("<span style='color: black; float:right;  font-weight:bold; margin-left:7px;' data-id='"+data.success[key].id+"'>Accept</span>");
                var denied = $("<span style='color: darkred;float:right; font-weight:bold; margin-left:7px;' data-id='"+data.success[key].id+"'>Denied</span>");
                var cancel_privilege = $("<span style='color: darkred;float:right; font-weight:bold; margin-left:7px;' data-id='"+data.success[key].id+"'>Cancel Privilege</span>");

                 if(data.success[key].is_admin){
                    $("#current_user_panel").append(box);
                    box.prepend(image,cancel_privilege);
                 }else {
                    $("#admin_request_panel").append(box);
                    box.prepend(image,denied,accept);
                 }
                 //$("#admin_request_panel").append(box);
                //
                accept.click(function(e){
                  e.stopPropagation();
                  console.log(this.dataset.id);
                  post("/update-user-info",{request_type:'admin_request',table_name:"users",target:"is_admin",id:this.dataset.id,value:1},function(data){
                    console.log("success",data);
                  });
                  displayAllUsers();
                });
                denied.click(function(e){
                  e.stopPropagation();
                  post("/update-user-info",{request_type:'admin_request',table_name:"users",target:"admin_request",id:this.dataset.id,value:0},function(data){
                    console.log("success",data);
                  });
                  displayAllUsers();
                });
                cancel_privilege.click(function(e){
                  e.stopPropagation();
                  post("/update-user-info",{request_type:'admin_request',table_name:"users",target:"is_admin",id:this.dataset.id,value:0},function(data){
                    console.log("success",data);
                  });
                  displayAllUsers();
                });
                 box.click({dataset:data.success[key]},function(e){

                   console.log("clicked",e.data.dataset);
                   var data =e.data.dataset;
                   $("#user_view_div_info").empty();
                   $("#user_view_div_info").fadeIn();
                   $("#user_view_div_image").empty();
                   $("#user_view_div_image").fadeIn();
                   $("#user_view_div_image").append("<img src='img/user.png' style='width:90%; height:90%;' alt=''>");
                   var table = $("<table style='width:100%;'></table>");
                  for(key in data){
                    if(key!== "id" && key!== "is_admin"){
                      table.append("<tr><td style='color:grey;'>"+upperCaseFirstLetter(key)+":</td><td>"+data[key]+"</td></tr>");
                      $("#user_view_div_info").append(table);

                    }
                  }

                });
              }
             }
         },
         error: function(){
            console.log("error #update_form");
          }
    });
  }
 }

$(".available_users").click(function(){
  console.log(this.dataset.id, $("#main_content")[0].dataset.id);

});
function displayIt(){

  $("#actor_info").toggle("fast");
}
function becomeActor(){
  $.ajax({
      url: "/update-user-status-to-actor",
      type: 'POST',
      success: function(data){
          if(data.success){
             console.log('response: ',data.success);
             location.assign("/user");
          }else{
            console.log(' There was a problem.');
           }
      },
      error: function(){
         console.log("error #update_form");
       }
 });
}

  $(".user_info_table small").click(function(){
     var name_ = this.dataset.name, value = this.dataset.value,label =this.dataset.label, table_name = this.dataset.table, car_id = this.dataset.tableid;
     console.log("name: ",name_,"label: ",label, "value: ",value,car_id);
     //create the frame
         if($("#edit_panel").length>0){
           $("#edit_panel").remove();
         }
         var box = $("<div id='edit_panel'style='border:1px solid lightgrey; width:auto; height:auto; position:absolute; top:0px; left:0px; font-size:0.8em;'></div>");
         var form = $("<form id='update_form'action='/update-user-info' method='post'></form>");
         box.append(form);
         var button_divs =$("<div class='modal-footer'></div>");
         var row1 = $("<div class='form-group col-md-6'></div>");
         var button_cancel = $("<button type='button' class='btn btn-secondary' data-dismiss='modal'>Cancel</button>");
         row1.append(button_cancel);
         var row2 = $("<div class='form-group col-md-6'></div>");
         var button_save = $("<button type='submit' class='btn btn-primary'>Save changes</button>");
         row2.append(button_save);
         button_divs.append(row1,row2);
         if(name_ ==="password"){
           var input_div =$("<div class='form-group'><label for='inputPassword0' class='col-form-label'>Password</label><input type='password' class='form-control' id='inputPassword0' placeholder='Password' name='password[current_password]'></div><div class='form-group'><label for='inputPassword' class='col-form-label'>New Password</label><input type='password' class='form-control' id='inputPassword' placeholder='Password' name='password[new_password]'></div><div class='form-group'><label for='input_confirmPass' class='col-form-label'>Confirm Password</label><input type='password' class='form-control' id='input_confirmPass' placeholder='Confirm New password' name='password[confirm_password]'><input type='hidden' name='table_name' value="+table_name+"></div>");
         }else if (name_ ==="cars") {
            var input_div =$("<div class='form-group'><label for='inputPassword0' class='col-form-label'>Make</label><input type='text' class='form-control' id='inputPassword0' placeholder='Make' name='cars[make]'></div><div class='form-group'><label for='inputPassword' class='col-form-label'>Color</label><input type='text' class='form-control' id='inputPassword' placeholder='Color' name='cars[color]'></div><div class='form-group'><label for='input_confirmPass' class='col-form-label'>Year</label><input type='text' class='form-control' id='input_confirmPass' placeholder='Year' name='cars[year]'><input type='hidden' name='cars[id]' value="+car_id+"><input type='hidden' name='table_name' value="+table_name+"></div>");
         }else if (name_ ==="ethnicity" || name_ ==="height" || name_ ==="sex" || name_ ==="us_citizen" ) {
             var input_div =$("<div class='form-group col-md-12'><label class='mr-sm-2' for='ethnicity_options'>New "+label+"</label><br><select class='custom-select mb-2 mr-sm-2 mb-sm-0' id='"+name_+"_options' name='"+name_+"'><option selected></option></select><input type='hidden' name='table_name' value="+table_name+"></div>");
         }
         else if (name_ ==="state") {
             var input_div =$("<div class='form-group col-md-12'><label class='mr-sm-2' for='inputState'>New "+label+"</label><br><input type='text' id='inputState'  class='form-control'  placeholder='state' name='"+name_+"'><input type='hidden' name='table_name' value="+table_name+"></div>");
         }else if (name_ ==="birthday") {
             var input_div =$("<div class='form-group col-md-12'><label class='mr-sm-2' for='inputDate'>New "+label+"</label><br><input type='date' id='inputDate'  class='form-control'  placeholder='state' name='"+name_+"'><input type='hidden' name='table_name' value="+table_name+"></div>");
         }
         else {
           var input_div =$("<div class='form-group col-md-12'><label class='mr-sm-2' for='inputEdit'>New "+label+"</label><br><input type='text' class='form-control' id='inputEdit' placeholder='"+value+"' name='"+name_+"'><input type='hidden' name='table_name' value="+table_name+"></div>");
         }
         var title =$("<div class='modal-header'><h5 class='modal-title'><center><h6>Editing</h6></center></h5>  </div>");
         var title_close =$("<button type='button' class='close' data-dismiss='modal' aria-label='Close' ><span aria-hidden='true'>&times;</span>  </button>");
         title.append(title_close);
        //  form.append("<center><h6>Editing</h6></center>",input_div,"<br>",button_divs);
        form.append(title,input_div,"<br>",button_divs);
         $("#main_content").append(box);
         var width = box.width(), height=box.height();
         var top= (window.innerHeight/2)+$(document).scrollTop()-(height/2) ;
         var left = (window.innerWidth/2)+$(document).scrollLeft() -(width/2);
         box.css({"top":top+"px" ,"left":left+"px"});
          button_cancel.click(function(){
            $("#edit_panel").remove();
          });
          title_close.click(function(){
            $("#edit_panel").remove();
          });

          button_save.click(function(e){
            //$("#edit_panel").remove();
          });
          //submit form

          $('#update_form').on('submit', function(evt){
                   evt.preventDefault();
                   $.ajax({
                     xhr: function() {
                           var xhr = new window.XMLHttpRequest();
                           // Upload progress
                           xhr.upload.addEventListener("progress", function(evt){
                               if (evt.lengthComputable) {
                                   var percentComplete = evt.loaded / evt.total;
                                   //Do something with upload progress
                                   console.log(Math.floor(percentComplete*100)+"%");
                               }
                          }, false);
                          return xhr;
                       },
                       url: "/update-user-info",
                       type: 'POST',
                       data: $(this).serialize(),
                       success: function(data){
                           if(data.success){
                              console.log('response: ',data.success);
                              console.log("target; afetr",$("#"+data.success.column_changed).html(data.success.value));
                             $("#edit_panel_success").remove();
                             $("#edit_panel").prepend("<center id='edit_panel_success'><span style='color:green;'>success</span></center>");
                              //location.assign("/user");
                           }else{
                             console.log(' There was a problem.');
                             $("#edit_panel_success").remove();
                             $("#edit_panel").prepend("<center id='edit_panel_success'><span style='color:red;'>Incorrect Entries</span></center>");
                            }
                       },
                       error: function(){
                          console.log("error #update_form");
                        }
                  });
                 });

                 $("#inputState").autocomplete({source: utility.states,});
                 ($("#ethnicity_options").length>0?utility.giveEtnicityToDropdown("ethnicity_options") :"");
                 ($("#height_options").length>0?utility.giveHeightToDropdown("height_options"):"");
                 ($("#sex_options").length>0?utility.giveGenderToDropdown("sex_options"):"");
                 ($("#us_citizen_options").length>0?utility.giveNoYesDropdown("us_citizen_options"):"");


  });

  $(".user_info_table tr").hover(function(e){
    $($(this).find("small")).css({"visibility":"visible"});
    //$(this).css({"border-bottom":"1px solid grey"});
  },
  function(){
    $($(this).find("small")).css({"visibility":"hidden"});
    $(this).css({"border-bottom":"none"});
  }
);



function getImages(){
  $.ajax({
    xhr: function() {
        var xhr = new window.XMLHttpRequest();

       //  // Upload progress
       //  xhr.upload.addEventListener("progress", function(evt){
       //      if (evt.lengthComputable) {
       //          var percentComplete = evt.loaded / evt.total;
       //          //Do something with upload progress
       //          console.log(percentComplete);
       //      }
       // }, false);

       // Download progress
       xhr.addEventListener("progress", function(evt){
           if (evt.lengthComputable) {
               var percentComplete = evt.loaded / evt.total;
               // Do something with download progress
               $("#progressBar").css({"width":""+percentComplete*100+"%"});
               $("#progressText").html(Math.floor(percentComplete*100)+"%");
               if(percentComplete===1){
                  $("#progressBarDiv").hide();
               }
           }
       }, false);

       return xhr;
    },
      url: "/get_user_images",
      type: 'POST',
      success: function(data){
          if(data.success){
             console.log('response: ',data.success);
             for(var i =0; i<5; i++){
               var image = $("<div class='profile_images' id='profile_image"+i+"' style='float:left; height:170px; width:19%;  margin-right:10px; position:relative; cursor:pointer; border:1px solid grey; display:none; ' ></div>");
               $("#images_area").append(image);
               var x = $("<div class='image_edit_btn' id ='image_edit_btn"+i+"' data-index='"+i+"' style='color:lightblue; position:absolute; top:45%; left:50%; cursor:pointer;display:none; '><span style='font-size:1.5em;'>+</span></div>");
               image.append(x);
             }
             for(var j =0; j<data.success.length; j++){
               var img = $("<img src='data:image/png;base64,"+data.success[j].image+"'  alt='profile photo'  style='height:100%; width:100%;'>");
               $("#profile_image"+j).append(img);
                $("#profile_image"+j).css({"border":"none","display":"block"});
                $(".imageDiv #addPhotoLink").remove();
                $("#image_edit_btn"+j).remove();
                var x = $("<div class='image_edit_btn' data-imagename='"+data.success[j].id+"' style='color:red; position:absolute; top:0px; left:90%; cursor:pointer; display:none; '>X</div>");
                $("#profile_image"+j).append(x);
             }
             $(".image_edit_btn").click(function(e){ // when clik on delete  or add button
               e.stopPropagation();
               if(this.dataset.index){//add a photo
                 if($("#image_upload_panel").length>0){
                   $("#image_upload_panel").remove();
                 }
                 var panel =$("<div id='image_upload_panel' style='border:1px solid lightgrey; width:300px; height: 200px; position:absolute; background-color:lightgrey; color:black;'></div>");
                 var close_btn =$("<button type='button' class='close' aria-label='Close'><span aria-hidden='true'>&times;</span></button>");
                 var photo_field =$("<div class='form-group'><form id='upload_image_form' enctype='multipart/form-data' action='upload_image"+this.dataset.index+"' method='POST'><label for='fieldPhoto' class ='col-form-label'>Upload Photo</label><div class='col-md-12' ><input type='file' class ='form-control' required accept='image/*'' id ='fieldPhoto' name='photo' ></div><br><br><button type='submit'>Upload</button></form></div>");
                 panel.append(close_btn,photo_field);
                 $("#main_content").append(panel);
                 var width = panel.width(), height=panel.height();
                 var top= (window.innerHeight/2)+$("body").scrollTop()-(height/2) ;
                 var left = (window.innerWidth/2)+$("body").scrollLeft() -(width/2);
                 panel.css({"top":top+"px" ,"left":left+"px"});
                 close_btn.click(function(){
                   $("#image_upload_panel").remove();
                 });
               }else if (this.dataset.imagename) { //delete the photo
                 if($("#confirm_delete_panel").length>0){
                   $("#confirm_delete_panel").remove();
                 }
                 var confirm_delete_panel =$("<div id='confirm_delete_panel' style='border:1px solid lightgrey; width:300px; height: 200px; position:absolute; background-color:lightgrey; color:black;'></div>");
                 $("#main_content").append(confirm_delete_panel);
                 var close_btn =$("<button type='button' class='close' aria-label='Close'><span aria-hidden='true'>&times;</span></button>");
                 var form = $("<form id='image_delete_form' action='/delete_image' method='POST'><center><h6>Are you sure?</h6></center><input type='hidden' name='image_name' value='"+this.dataset.imagename+"'></form>");
                 var buttons = $("<div style='width:150px; margin:0 auto;'><button id='image_delete_cancel_btn' type='button' style='float:left; cursor:pointer; width:70px;'>No</button><button type='submit' form='image_delete_form' value='Submit' style='float:right; cursor:pointer; width:70px;'>Yes</button></div>");
                 confirm_delete_panel.append(close_btn,"<br></br>",form,"<br></br>",buttons);
                 var width = confirm_delete_panel.width(), height=confirm_delete_panel.height();
                 var top= (window.innerHeight/2)+$("body").scrollTop()-(height/2) ;
                 var left = (window.innerWidth/2)+$("body").scrollLeft() -(width/2);
                 confirm_delete_panel.css({"top":top+"px" ,"left":left+"px"});
                 close_btn.click(function(){
                   $("#confirm_delete_panel").remove();
                 });
                 $("#image_delete_cancel_btn").click(function(){
                   $("#confirm_delete_panel").remove();
                 });
               }
             });
             //
             $(".profile_images").click(function(e){
                e.stopPropagation();
                if($(this).find("img").length>0){
                  $(".image_edit_btn").toggle("fast");
                  for(var i=0; i<$(".profile_images").length; i++){
                    if($($(".profile_images")[i]).find("img").length<=0){//no image
                      $($(".profile_images")[i]).toggle("fast");
                    }
                  }
                }
             });
             //
             $(".imageDiv #addPhotoLink").click(function(){
               $(".image_edit_btn").toggle("fast");
               for(var i=0; i<$(".profile_images").length; i++){
                 if($($(".profile_images")[i]).find("img").length<=0){//no image
                   $($(".profile_images")[i]).toggle("fast");
                 }
               }
               $(this).remove();
             });
          }else{
            console.log(' There was a problem.images');
           }
      },
      error: function(){
         //$ container.html(' There was a problem.');
         console.log("error");
       }
 });
}
getImages();

function upperCaseIt(word){
  return word[0].toUpperCase()+word.substring(1,word.length);
}
function upperCaseFirstLetter(word0){
  var word = word0.split("_");
  var new_Word=false;
  for(var i =0; i<word.length; i++){
    if(!new_Word){
      new_Word = upperCaseIt(word[i]);
    }else {
        new_Word+=" "+upperCaseIt(word[i]);
    }
  }
  return new_Word;
}
function post(url,data0,callback){
  console.log("post")
  $.ajax({
      url: url,
      type: 'POST',
      data:data0,
      success: function(data){
          if(data.success){
             callback(data.success);
          }else{
            console.log(' There was a problem.',url);
           }
      },
      error: function(){
         //$ container.html(' There was a problem.');
         console.log("error get_user_images");
       }
 });
}

</script>

   {{else}}
 <h1>sorry, you are not allowed to view this page now, please log in </h1>
{{/if}}
